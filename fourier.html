<!DOCTYPE html>
<html>

<head>
    <title>Fourier</title>
    <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />
    <style>
        #box {
            width: 1000px;
            height: 600px;
        }
    </style>
</head>

<body>

    <div id="box" class="jxgbox"></div>
    <div>
        <input type="checkbox" name="check" id="sine1" checked> 1
        <input type="checkbox" name="check" id="sine2" checked> 2
        <input type="checkbox" name="check" id="sine3" checked> 3
        <input type="checkbox" name="check" id="sine4" checked> 4
        <input type="checkbox" name="check" id="sine5" checked> 5
        <input type="checkbox" name="check" id="sine6" checked> 6
        <input type="checkbox" name="check" id="sine7" checked> 7
    </div>

    <script>
        const board = JXG.JSXGraph.initBoard('box', {
            boundingbox: [-2, 2, 10, -2],
            axis: true
        });

        const harmonics = [1, 2, 3, 4, 5, 6, 7]
        const colors = ['red', 'orange', 'gold', 'green', 'blue', 'purple', 'magenta']
        const toggle = [true, true, true, true, true, true, true]
        const waves = [];

        const squareWave = board.create('functiongraph', [
            function (t) {
                return Math.sign(Math.sin(t));
            },
            -2, 10
        ], { strokeColor: 'blue', strokeWidth: 2 });

        harmonics.forEach((n, i) => {
            const wave = board.create('functiongraph', [
                function (t) {
                    return toggle[i] ? Math.sin(n * t) : 0;
                },
                -2, 10
            ], { strokeColor: colors[i], strokeWidth: 2, opacity: 0.2 });
            waves.push(wave);
        })

        const composite = board.create('functiongraph', [
            function (t) {
                let sum = 0;
                for (let i = 0; i < harmonics.length; i++) {
                    if (toggle[i]) {
                        const n = harmonics[i];
                        const A = 4 / (n * Math.PI);
                        sum += A * Math.sin(n * t);
                    }
                }
                return sum;
            },
            -2, 10
        ], { strokeColor: '#f00', strokeWidth: 2 });


        const checkboxes = document.querySelectorAll('input[name="check"]');

        checkboxes.forEach((checkbox, index) => {
            checkbox.addEventListener('change', () => {
                toggle[index] = checkbox.checked;
                //console.log(index, toggle[index]);
                board.update();
            });
        });



    </script>

</body>

</html>