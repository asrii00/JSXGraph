<!DOCTYPE html>
<html>

<head>
  <title>JSXGraph Example</title>
  <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />
  <style>
    #box {
      width: 1000px;
      height: 810px;
    }
  </style>
</head>

<body>

  <div id="box" class="jxgbox"></div>

  <script>
    const board = JXG.JSXGraph.initBoard('box', {
      boundingbox: [0, 14.95, 16, 0],
      axis: false,
      showCopyright: false,
      showNavigation: false
    });

    const array = [];
    const xStart = 2;
    const axisXStart = 0.5;
    const yStart = 11;

    //kinda finicky/breaks if you change canvas size or board boundingbox in the wrong way :'D
    function drawApple(x, y, radius) {
      const red = board.create('point', [x, y], { color: 'red', size: radius, name: '', layer: 5 });
      const unit = radius / 200;
      const leafSize = 2 * unit;

      const highlight = board.create('point', [x - unit * 2, y + 1.7 * unit], { color: 'white', name: '', opacity: 0.8, size: radius * 0.05 })
      const topbit = board.create('point', [x, y + 7.5 * unit], { color: 'white', name: '', size: radius, layer: 8, highlight: false });
      const a = board.create('point', [x, y + 6 * unit], { name: '', visible: false });
      const b = board.create('point', [x, y + 3.25 * unit], { name: '', visible: false });
      const l = board.create('line', [a, b], { layer: 10, color: 'black', straightFirst: false, straightLast: false, strokeWidth: 3 })

      const lx = x + 0.1 * unit;
      const ly = y + 3.55 * unit;

      points = [[lx, ly], [lx + leafSize, ly + leafSize], [lx, ly + leafSize / 3]];
      board.create('ellipse', points, {
        strokeColor: 'green',
        fillColor: 'green',
        strokeWidth: 2,
        layer: 9
      });
    }

    const axisStart = board.create('point', [axisXStart, 0.5], { visible: false })
    const axisEnd = board.create('point', [15.5, 0.5], { visible: false })
    const axis = board.create('line', [axisStart, axisEnd], { straightFirst: false, straightLast: false, strokeColor: 'black', strokeWidth: 1 })

    const xTicks = board.create('ticks', [axis], {
      drawLabels: true,
      ticksDistance: 1,
      label: {
        offset: [-6, -15]
      },
      minorTicks: 3
    });

    xTicks.generateLabelText = function (tick, zero) {
      return (tick.usrCoords[1] * 10).toFixed(0); 
    };
    board.create('text', [15, 0.4, 'päivää'], {
                anchorX: 'center',
                anchorY: 'center'
            })

    function getRandomBetween(min, max) {
      return Math.random() * (max - min) + min;
    }

    for (let i = 0; i < 10; i++) {
      const randomLength = getRandomBetween(70, 110);
      array.push({ i: i, length: randomLength })
    }

    array.forEach((tree, i) => {
      const treeNumberStr = "Puu nro. " + (i + 1)
      const y = yStart - i * 1;
      const endOfLine = xStart + tree.length / 10;
      const label = board.create('text', [xStart - 1.5, y, treeNumberStr])

      const a = board.create('point', [xStart, y], { visible: false })
      const b = board.create('point', [endOfLine, y], { visible: false })
      const l = board.create('line', [a, b], { straightFirst: false, straightLast: false, color: 'green', strokeWidth: 5 })

      drawApple(endOfLine, y + 0.35, 10)
    })

  </script>

</body>

</html>