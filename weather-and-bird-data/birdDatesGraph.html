<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
    <script src="birdDates.js"></script>
    <script src="thermal_summer_starts2.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />
</head>

<body>
    <div id="jxgbox" style="width:1200px; height:800px;"></div>
    <script>
        const board = JXG.JSXGraph.initBoard('jxgbox', {
            boundingbox: [-2, 2021, 95, 2026],
            axis: true
        });

        const allDateSets = [
            { dates: kiuruDates, color: 'red' },
            { dates: peippoDates, color: 'blue' },
            { dates: vastarakkiDates, color: 'green' },
            { dates: paaskytDates, color: 'orange' }
        ];
        function calculateDayDiff(date, index) {
            const offset = index * 0.1;
            const year = date.getFullYear();
            const marchFirst = new Date(year, 2, 1);
            const diffMs = date - marchFirst;
            const diffDays = (diffMs / (1000 * 60 * 60 * 24)).toFixed(0);
            return {
                year: year + offset,
                daysSinceMarch1: diffDays
            };
        }

        allDateSets.forEach((set, index) => {
            const xDays = set.dates.map(date => {
                return calculateDayDiff(date, index)

            });

            xDays.forEach(x => {
                board.create('point', [x.daysSinceMarch1, x.year], {
                    name: '',
                    size: 4,
                    color: set.color,
                    opacity: 0.3,
                    fixed: true
                });
            });
        });

        const thermalSummerDays = thermalSummerStartsShort.map(entry => {
            const summerStartDate = new Date(entry.thermal_summer_start);
            return calculateDayDiff(summerStartDate, 4)
        })
        thermalSummerDays.forEach(x => {
            const a = board.create('point', [x.daysSinceMarch1, x.year-0.5], {
                name: '',
                size: 1,
                color: 'purple',
                opacity: 0.9,
                fixed: true
            });
            const b = board.create('point', [x.daysSinceMarch1, x.year], {
                name: '',
                size: 1,
                color: 'purple',
                opacity: 0.9,
                fixed: true
            });
            const line = board.create('line',  [a, b], {straightFirst:false, straightLast:false, color: 'purple'})
        });

    </script>
</body>

</html>