<!DOCTYPE html>
<html>

<head>
  <title>JSXGraph Example</title>
  <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css" />
  <style>
    #box {
      width: 1200px;
      height: 300px;
    }

    .flex-container {
      display: flex;
      gap: 20px;
      align-items: flex-start;
      padding: 10px;
    }
  </style>
</head>

<body>
  <div class="flex-container">
    <div id="box" class="jxgbox"></div>
  </div>
  <div>
    <button onclick="">Start</button>

  </div>
  <div style="margin-top: 1em;">
    <label for="base-output">Sekvenssi tekstin√§</label><br>
    <textarea id="base-output" rows="4" cols="99" readonly style="resize: none; font-family: monospace;">A</textarea>
  </div>

  <script>
    const board = JXG.JSXGraph.initBoard('box', {
      boundingbox: [0, 0, 250, 100],
      axis: false,
      showNavigation: false,
    });

    const fasta = 'CCACACCACACCCACACACCCACACACCACACCACACACCACACCACACCCACACACACACATCCTAACACTACCCTAACACAGCCCTAATCTAACCCTGGCCAACCTGTCTCTCAACTTACCCTCCATTACCCTGCCTCCACTCGTTACCCTGTCCCATTCAACCATACCACTCCGAACCACCATCCATCCCTCTACTT'

    const baseColors = {
      A: '#D35A5F',
      C: '#D278B5',
      G: '#9B84D2',
      T: '#6FA3E6'
    };

    const radius = 2.4;
    const columns = 50;
    const startX = 7;
    const startY = 15;
    const ySpacing = 10;

    const circles = [];
    const circleLabels = [];
    //const bases = [];
    
    function drawCircle(x, y, base, color) {
      circles.push(board.create('circle', [
        [x, y], radius
      ], {
        strokeColor: color,
        fillColor: color,
        fillOpacity: 0.8,
        strokeWidth: 2,
        fixed: true
      }));
      circleLabels.push(board.create('text', [
        x, y, base
      ], {
        anchorX: 'middle',
        anchorY: 'middle',
        fontSize: 14,
        fixed: true
      }));
    }

    function getPositionForIndex(index) {
      const x = startX + 2 * radius * (index % columns);
      const y = startY + ySpacing * Math.floor(index / columns);
      return { x: x, y: y };
    }

    function drawBase(base, index, color) {
      const pos = getPositionForIndex(index);
      drawCircle(pos.x, pos.y, base, 'lightgrey');
      //bases.push({ index: index, x: pos.x, y: pos.y, base: base })
    }

    function draw() {
      for (let i = 0; i < fasta.length; i++) {
        const base = fasta[i];
        drawBase(base, i, baseColors[base]) // not using colors atm
      }
      document.getElementById('base-output').value = fasta;
    }

    draw();

  </script>

</body>

</html>